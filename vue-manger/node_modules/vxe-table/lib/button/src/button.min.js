"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _xeUtils=_interopRequireDefault(require("xe-utils/methods/xe-utils")),_conf=_interopRequireDefault(require("../../conf")),_tools=require("../../tools");function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _defineProperty(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var _default2={name:"VxeButton",props:{type:String,size:{type:String,default:function(){return _conf.default.button.size||_conf.default.size}},name:[String,Number],content:String,placement:String,status:String,icon:String,disabled:Boolean,loading:Boolean,transfer:{type:Boolean,default:function(){return _conf.default.button.transfer}}},data:function(){return{showPanel:!1,animatVisible:!1,panelIndex:0,panelStyle:null,panelPlacement:null}},computed:{vSize:function(){return this.size||this.$parent.size||this.$parent.vSize},isText:function(){return"text"===this.type},isFormBtn:function(){return-1<["submit","reset","button"].indexOf(this.type)},btnType:function(){return this.isText?this.type:"button"},btnStatus:function(){return this.status||("primary"===this.type?this.type:null)}},created:function(){"primary"===this.type&&_tools.UtilTools.warn("vxe.error.delProp",["type=primary","status=primary"]),_tools.GlobalEvent.on(this,"syncwheel",this.handleSyncwheelEvent)},mounted:function(){var t=this.$refs.panel;t&&this.transfer&&document.body.appendChild(t)},beforeDestroy:function(){var t=this.$refs.panel;t&&t.parentNode&&t.parentNode.removeChild(t)},destroyed:function(){_tools.GlobalEvent.off(this,"syncwheel")},render:function(t){var e,n,o,i,s=this,a=this.$scopedSlots,r=this.$listeners,l=this.type,u=this.isFormBtn,c=this.btnStatus,d=this.btnType,p=this.vSize,f=this.name,h=this.disabled,m=this.loading,v=this.showPanel,b=this.animatVisible,y=this.panelPlacement;return a.dropdowns?t("div",{class:["vxe-button--dropdown",(_defineProperty(e={},"size--".concat(p),p),_defineProperty(e,"is--active",v),e)]},[t("button",{ref:"btn",class:["vxe-button","type--".concat(d),(_defineProperty(n={},"size--".concat(p),p),_defineProperty(n,"theme--".concat(c),c),_defineProperty(n,"is--disabled",h||m),_defineProperty(n,"is--loading",m),n)],attrs:{name:f,type:u?l:"button",disabled:h||m},on:Object.assign({mouseenter:this.mouseenterEvent,mouseleave:this.mouseleaveEvent},_xeUtils.default.objectMap(r,function(t,e){return function(t){return s.$emit(e,{$event:t},t)}}))},this.renderContent(t).concat([t("i",{class:"vxe-button--dropdown-arrow ".concat(_conf.default.icon.BUTTON_DROPDOWN)})])),t("div",{ref:"panel",class:["vxe-button--dropdown-panel",(_defineProperty(o={},"size--".concat(p),p),_defineProperty(o,"animat--leave",b),_defineProperty(o,"animat--enter",v),o)],attrs:{"data-placement":y},style:this.panelStyle},[t("div",{class:"vxe-button--dropdown-wrapper",on:{click:this.clickDropdownEvent,mouseenter:this.mouseenterEvent,mouseleave:this.mouseleaveEvent}},a.dropdowns.call(this))])]):t("button",{ref:"btn",class:["vxe-button","type--".concat(d),(_defineProperty(i={},"size--".concat(p),p),_defineProperty(i,"theme--".concat(c),c),_defineProperty(i,"is--disabled",h||m),_defineProperty(i,"is--loading",m),i)],attrs:{name:f,type:u?l:"button",disabled:h||m},on:_xeUtils.default.objectMap(r,function(t,e){return function(t){return s.$emit(e,{$event:t},t)}})},this.renderContent(t))},methods:{renderContent:function(t){var e=this.$scopedSlots,n=this.content,o=this.icon,i=[];return this.loading?i.push(t("i",{class:["vxe-button--loading-icon",_conf.default.icon.BUTTON_LOADING]})):o&&i.push(t("i",{class:["vxe-button--icon",o]})),e.default?i.push(t("span",{class:"vxe-button--content"},e.default.call(this))):n&&i.push(t("span",{class:"vxe-button--content"},[_tools.UtilTools.getFuncText(n)])),i},handleSyncwheelEvent:function(t){this.showPanel&&!_tools.DomTools.getEventTargetNode(t,this.$refs.panel).flag&&(console.log(111),this.updatePlacement())},updateZindex:function(){this.panelIndex<_tools.UtilTools.getLastZIndex()&&(this.panelIndex=_tools.UtilTools.nextZIndex())},clickDropdownEvent:function(t){var e=this,n=t.currentTarget,o=this.$refs.panel,i=_tools.DomTools.getEventTargetNode(t,n,"vxe-button"),s=i.flag,a=i.targetElem;s&&(o.dataset.active="N",this.showPanel=!1,setTimeout(function(){"Y"!==o.dataset.active&&(e.animatVisible=!1)},200),this.$emit("dropdown-click",{name:a.getAttribute("name"),$event:t},t))},mouseenterEvent:function(){var t=this,e=this.$refs.panel;e.dataset.active="Y",this.animatVisible=!0,setTimeout(function(){"Y"===e.dataset.active&&(t.showPanel=!0,t.updateZindex(),t.updatePlacement())},10)},mouseleaveEvent:function(){var t=this,e=this.$refs.panel;e.dataset.active="N",setTimeout(function(){"Y"!==e.dataset.active&&(t.showPanel=!1,setTimeout(function(){"Y"!==e.dataset.active&&(t.animatVisible=!1)},200))},200)},updatePlacement:function(){var b=this;this.$nextTick(function(){var t=b.$refs,e=b.transfer,n=b.placement,o=b.panelIndex,i=t.btn,s=t.panel,a=i.offsetHeight,r=i.offsetWidth,l=s.offsetHeight,u=s.offsetWidth,c={zIndex:o,minWidth:"".concat(r,"px")},d=_tools.DomTools.getAbsolutePos(i),p=d.boundingTop,f=d.boundingLeft,h=d.visibleHeight,m="bottom";if(e){var v=p+a;"top"===n?(m="top",v=p-l):(h<v+l&&(m="top",v=p-l),v<0&&(m="bottom",v=p+a)),c.left="".concat(f,"px"),c.top="".concat(v,"px")}else"top"===n?(m="top",c.bottom="".concat(a,"px")):h<p+a+l&&(m="top",c.bottom="".concat(a,"px")),r<u&&(c.left="".concat((r-u)/2,"px"));b.panelStyle=c,b.panelPlacement=m})}}};exports.default=_default2;