"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.Cell=void 0;var _xeUtils=_interopRequireDefault(require("xe-utils/methods/xe-utils")),_conf=_interopRequireDefault(require("../../conf")),_vXETable=_interopRequireDefault(require("../../v-x-e-table")),_tools=require("../../tools");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var Cell={createColumn:function(e,r){var l=r.type,t=r.sortable,n=r.remoteSort,c=r.filters,o=r.editRender,a=r.treeNode,d=e.editConfig,i=e.editOpts,s=e.checkboxOpts,u={renderHeader:this.renderDefaultHeader,renderCell:a?this.renderTreeCell:this.renderDefaultCell,renderFooter:this.renderDefaultFooter};switch(l){case"seq":case"index":u.renderHeader=this.renderIndexHeader,u.renderCell=a?this.renderTreeIndexCell:this.renderIndexCell;break;case"radio":u.renderHeader=this.renderRadioHeader,u.renderCell=a?this.renderTreeRadioCell:this.renderRadioCell;break;case"checkbox":case"selection":u.renderHeader=this.renderSelectionHeader,u.renderCell=s.checkField?a?this.renderTreeSelectionCellByProp:this.renderSelectionCellByProp:a?this.renderTreeSelectionCell:this.renderSelectionCell;break;case"expand":u.renderCell=this.renderExpandCell,u.renderData=this.renderExpandData;break;case"html":u.renderCell=a?this.renderTreeHTMLCell:this.renderHTMLCell,c&&(t||n)?u.renderHeader=this.renderSortAndFilterHeader:t||n?u.renderHeader=this.renderSortHeader:c&&(u.renderHeader=this.renderFilterHeader);break;default:d&&o?(u.renderHeader=this.renderEditHeader,u.renderCell="cell"===i.mode?a?this.renderTreeCellEdit:this.renderCellEdit:a?this.renderTreeRowEdit:this.renderRowEdit):c&&(t||n)?u.renderHeader=this.renderSortAndFilterHeader:t||n?u.renderHeader=this.renderSortHeader:c&&(u.renderHeader=this.renderFilterHeader)}return _tools.UtilTools.getColumnConfig(e,r,u)},renderDefaultHeader:function(e,r){var l=r.$table,t=r.column,n=t.slots,c=t.own,o=c.editRender||c.cellRender;if(n&&n.header)return[e("span",{class:"vxe-cell--title"},n.header.call(l,r,e))];if(o){var a=_vXETable.default.renderer.get(o.name);if(a&&a.renderHeader)return[e("span",{class:"vxe-cell--title"},a.renderHeader.call(l,e,o,r,{$grid:l.$xegrid,$excel:l.$parent,$table:l}))]}return[e("span",{class:"vxe-cell--title"},_tools.UtilTools.formatText(t.getTitle(),1))]},renderDefaultCell:function(e,r){var l=r.$table,t=r.row,n=r.column,c=n.slots,o=n.own,a=o.editRender||o.cellRender;if(c&&c.default)return c.default.call(l,r,e);if(a){var d=o.editRender?"renderCell":"renderDefault",i=_vXETable.default.renderer.get(a.name);if(i&&i[d])return i[d].call(l,e,a,Object.assign({$type:o.editRender?"edit":"cell",isEdit:!!o.editRender},r),{$type:o.editRender?"edit":"cell",$grid:l.$xegrid,$excel:l.$parent,$table:l})}return[_tools.UtilTools.formatText(_tools.UtilTools.getCellLabel(t,n,r),1)]},renderTreeCell:function(e,r){return Cell.renderTreeIcon(e,r,Cell.renderDefaultCell.call(this,e,r))},renderDefaultFooter:function(e,r){var l=r.$table,t=r.column,n=r._columnIndex,c=r.items,o=t.slots,a=t.own,d=a.editRender||a.cellRender;if(o&&o.footer)return o.footer.call(l,r,e);if(d){var i=_vXETable.default.renderer.get(d.name);if(i&&i.renderFooter)return i.renderFooter.call(l,e,d,r,{$grid:l.$xegrid,$excel:l.$parent,$table:l})}return[_tools.UtilTools.formatText(c[n],1)]},renderTreeIcon:function(e,r,l){var t=r.$table,n=r.isHidden,c=t.treeOpts,o=t.treeExpandeds,a=t.treeLazyLoadeds,d=r.row,i=r.column,s=r.level,u=i.slots,f=c.children,x=c.hasChild,v=c.indent,h=c.lazy,b=c.trigger,C=c.iconLoaded,p=c.iconOpen,T=c.iconClose,_=d[f],E=!1,k=!1,m=!1,g={};return u&&u.icon?u.icon.call(t,r,e,l):(n||(k=-1<o.indexOf(d),h&&(m=-1<a.indexOf(d),E=d[x])),b&&"default"!==b||(g.click=function(e){return t.triggerTreeExpandEvent(e,r)}),[e("div",{class:["vxe-cell--tree-node",{"is--active":k}],style:{paddingLeft:"".concat(s*v,"px")}},[_&&_.length||E?[e("div",{class:"vxe-tree--btn-wrapper",on:g},[e("i",{class:["vxe-tree--node-btn",m?C||_conf.default.icon.TABLE_TREE_LOADED:k?p||_conf.default.icon.TABLE_TREE_OPEN:T||_conf.default.icon.TABLE_TREE_CLOSE]})])]:null,e("div",{class:"vxe-tree-cell"},l)])])},renderIndexHeader:function(e,r){var l=r.$table,t=r.column,n=t.slots;return[e("span",{class:"vxe-cell--title"},n&&n.header?n.header.call(l,r,e):_tools.UtilTools.formatText(t.getTitle(),1))]},renderIndexCell:function(e,r){var l=r.$table,t=r.column,n=l.seqOpts,c=l.startIndex,o=t.slots;if(o&&o.default)return o.default.call(l,r,e);var a=r.$seq,d=r.seq,i=r.level,s=n.seqMethod||t.seqMethod||t.indexMethod;return[_tools.UtilTools.formatText(s?s(r):i?"".concat(a,".").concat(d):(n.startIndex||c)+d,1)]},renderTreeIndexCell:function(e,r){return Cell.renderTreeIcon(e,r,Cell.renderIndexCell(e,r))},renderRadioHeader:function(e,r){var l=r.$table,t=r.column,n=t.slots;return[e("span",{class:"vxe-cell--title"},n&&n.header?n.header.call(l,r,e):[e("span",{class:"vxe-radio--label"},_tools.UtilTools.formatText(t.getTitle(),1))])]},renderRadioCell:function(e,r){var l,t=r.$table,n=r.column,c=r.isHidden,o=t.radioOpts,a=t.selectRow,d=n.slots,i=o.labelField,s=o.checkMethod,u=r.row,f=u===a,x=!!s;return c||(l={click:function(e){x||t.triggerRadioRowEvent(e,r)}},s&&(x=!s(r))),[e("span",{class:["vxe-cell--radio",{"is--checked":f,"is--disabled":x}],on:l},[e("span",{class:"vxe-radio--icon vxe-radio--checked-icon"}),e("span",{class:"vxe-radio--icon vxe-radio--unchecked-icon"})].concat(d&&d.default?d.default.call(t,r,e):i?[e("span",{class:"vxe-radio--label"},_xeUtils.default.get(u,i))]:[]))]},renderTreeRadioCell:function(e,r){return Cell.renderTreeIcon(e,r,Cell.renderRadioCell(e,r))},renderSelectionHeader:function(e,r){var l,t=r.$table,n=r.column,c=r.isHidden,o=t.isIndeterminate,a=t.isAllCheckboxDisabled,d=n.slots,i=n.own,s=t.checkboxOpts,u=i.title||i.label,f=!1;return(s.checkStrictly?s.showHeader:!1!==s.showHeader)?(c||(f=!a&&t.isAllSelected,l={click:function(e){a||t.triggerCheckAllEvent(e,!f)}}),[e("span",{class:"vxe-cell--title"},[e("span",{class:["vxe-cell--checkbox",{"is--checked":f,"is--disabled":a,"is--indeterminate":o}],attrs:{title:_conf.default.i18n("vxe.table.allTitle")},on:l},[e("span",{class:"vxe-checkbox--icon vxe-checkbox--checked-icon"}),e("span",{class:"vxe-checkbox--icon vxe-checkbox--unchecked-icon"}),e("span",{class:"vxe-checkbox--icon vxe-checkbox--indeterminate-icon"})].concat(d&&d.header?d.header.call(t,r,e):u?[e("span",{class:"vxe-checkbox--label"},u)]:[]))])]):[e("span",{class:"vxe-cell--title"},d&&d.header?d.header.call(t,r,e):[e("span",{class:"vxe-checkbox--label"},u)])]},renderSelectionCell:function(e,r){var l,t=r.$table,n=r.row,c=r.column,o=r.isHidden,a=t.treeConfig,d=t.treeIndeterminates,i=t.checkboxOpts,s=i.labelField,u=i.checkMethod,f=c.slots,x=!1,v=!1,h=!!u;return o||(v=-1<t.selection.indexOf(n),l={click:function(e){h||t.triggerCheckRowEvent(e,r,!v)}},u&&(h=!u(r)),a&&(x=-1<d.indexOf(n))),[e("span",{class:["vxe-cell--checkbox",{"is--checked":v,"is--disabled":h,"is--indeterminate":x}],on:l},[e("span",{class:"vxe-checkbox--icon vxe-checkbox--checked-icon"}),e("span",{class:"vxe-checkbox--icon vxe-checkbox--unchecked-icon"}),e("span",{class:"vxe-checkbox--icon vxe-checkbox--indeterminate-icon"})].concat(f&&f.default?f.default.call(t,r,e):s?[e("span",{class:"vxe-checkbox--label"},_xeUtils.default.get(n,s))]:[]))]},renderTreeSelectionCell:function(e,r){return Cell.renderTreeIcon(e,r,Cell.renderSelectionCell(e,r))},renderSelectionCellByProp:function(e,r){var l,t=r.$table,n=r.row,c=r.column,o=r.isHidden,a=t.treeConfig,d=t.treeIndeterminates,i=t.checkboxOpts,s=i.labelField,u=i.checkField,f=i.checkMethod,x=c.slots,v=!1,h=!1,b=!!f;return o||(h=_xeUtils.default.get(n,u),l={click:function(e){b||t.triggerCheckRowEvent(e,r,!h)}},f&&(b=!f(r)),a&&(v=-1<d.indexOf(n))),[e("span",{class:["vxe-cell--checkbox",{"is--checked":h,"is--disabled":b,"is--indeterminate":v}],on:l},[e("span",{class:"vxe-checkbox--icon vxe-checkbox--checked-icon"}),e("span",{class:"vxe-checkbox--icon vxe-checkbox--unchecked-icon"}),e("span",{class:"vxe-checkbox--icon vxe-checkbox--indeterminate-icon"})].concat(x&&x.default?x.default.call(t,r,e):s?[e("span",{class:"vxe-checkbox--label"},_xeUtils.default.get(n,s))]:[]))]},renderTreeSelectionCellByProp:function(e,r){return Cell.renderTreeIcon(e,r,Cell.renderSelectionCellByProp(e,r))},renderExpandCell:function(e,r){var l=r.$table,t=r.isHidden,n=r.row,c=r.column,o=l.expandOpts,a=l.rowExpandeds,d=l.expandLazyLoadeds,i=o.lazy,s=o.labelField,u=o.iconLoaded,f=o.iconOpen,x=o.iconClose,v=o.visibleMethod,h=c.slots,b=!1,C=!1;return h&&h.icon?h.icon.call(l,r,e):(t||(b=-1<a.indexOf(r.row),i&&(C=-1<d.indexOf(n))),[!v||v(r)?e("span",{class:["vxe-table--expanded",{"is--active":b}],on:{click:function(e){l.triggerRowExpandEvent(e,r)}}},[e("i",{class:["vxe-table--expand-btn",C?u||_conf.default.icon.TABLE_EXPAND_LOADED:b?f||_conf.default.icon.TABLE_EXPAND_OPEN:x||_conf.default.icon.TABLE_EXPAND_CLOSE]})]):null,e("span",{class:"vxe-table--expand-label"},h&&h.default?h.default.call(l,r,e):s?_xeUtils.default.get(n,s):null)])},renderExpandData:function(e,r){var l=r.$table,t=r.column,n=t.slots,c=t.contentRender;if(n){if(n.content)return n.content.call(l,r,e);if(n.default)return n.default.call(l,r,e)}if(c){var o=_vXETable.default.renderer.get(c.name);if(o&&o.renderExpand)return o.renderExpand.call(l,e,c,r,{$grid:l.$xegrid,$table:l})}return[]},renderHTMLCell:function(e,r){var l=r.$table,t=r.row,n=r.column,c=n.slots;return c&&c.default?c.default.call(l,r,e):[e("span",{class:"vxe-cell--html",domProps:{innerHTML:_tools.UtilTools.formatText(_tools.UtilTools.getCellLabel(t,n,r),1)}})]},renderTreeHTMLCell:function(e,r){return Cell.renderTreeIcon(e,r,Cell.renderHTMLCell(e,r))},renderSortAndFilterHeader:function(e,r){return Cell.renderDefaultHeader(e,r).concat(Cell.renderSortIcon(e,r)).concat(Cell.renderFilterIcon(e,r))},renderSortHeader:function(e,r){return Cell.renderDefaultHeader(e,r).concat(Cell.renderSortIcon(e,r))},renderSortIcon:function(e,r){var l=r.$table,t=r.column,n=l.sortOpts,c=n.showIcon,o=n.iconAsc,a=n.iconDesc;return!1===c?[]:[e("span",{class:"vxe-cell--sort"},[e("i",{class:["vxe-sort--asc-btn",o||_conf.default.icon.TABLE_SORT_ASC,{"sort--active":"asc"===t.order}],attrs:{title:_conf.default.i18n("vxe.table.sortAsc")},on:{click:function(e){l.triggerSortEvent(e,t,"asc")}}}),e("i",{class:["vxe-sort--desc-btn",a||_conf.default.icon.TABLE_SORT_DESC,{"sort--active":"desc"===t.order}],attrs:{title:_conf.default.i18n("vxe.table.sortDesc")},on:{click:function(e){l.triggerSortEvent(e,t,"desc")}}})])]},renderFilterHeader:function(e,r){return Cell.renderDefaultHeader(e,r).concat(Cell.renderFilterIcon(e,r))},renderFilterIcon:function(e,r){var l=r.$table,t=r.column,n=r.hasFilter,c=l.filterStore,o=l.filterOpts,a=o.showIcon,d=o.iconNone,i=o.iconMatch;return!1===a?[]:[e("span",{class:["vxe-cell--filter",{"is--active":c.visible&&c.column===t}]},[e("i",{class:["vxe-filter--btn",n?i||_conf.default.icon.TABLE_FILTER_MATCH:d||_conf.default.icon.TABLE_FILTER_NONE],attrs:{title:_conf.default.i18n("vxe.table.filter")},on:{click:function(e){l.triggerFilterEvent(e,r.column,r)}}})])]},renderEditHeader:function(e,r){var l,t=r.$table,n=r.column,c=t.editRules,o=t.editOpts,a=n.sortable,d=n.remoteSort,i=n.filters;if(c){var s=_xeUtils.default.get(c,r.column.property);s&&(l=s.some(function(e){return e.required}))}return[l?e("i",{class:"vxe-required-icon"}):null,!1===o.showIcon?null:e("i",{class:["vxe-edit-icon",o.icon||_conf.default.icon.TABLE_EDIT]})].concat(Cell.renderDefaultHeader(e,r)).concat(a||d?Cell.renderSortIcon(e,r):[]).concat(i?Cell.renderFilterIcon(e,r):[])},renderRowEdit:function(e,r){var l=r.$table.editStore.actived;return Cell.runRenderer(e,r,this,l&&l.row===r.row)},renderTreeRowEdit:function(e,r){return Cell.renderTreeIcon(e,r,Cell.renderRowEdit(e,r))},renderCellEdit:function(e,r){var l=r.$table.editStore.actived;return Cell.runRenderer(e,r,this,l&&l.row===r.row&&l.column===r.column)},renderTreeCellEdit:function(e,r){return Cell.renderTreeIcon(e,r,Cell.renderCellEdit(e,r))},runRenderer:function(e,r,l,t){var n=r.$table,c=r.row,o=r.column,a=o.slots,d=o.own,i=o.formatter,s=d.editRender,u=_vXETable.default.renderer.get(s.name);return"visible"===s.type||t?a&&a.edit?a.edit.call(n,r,e):u&&u.renderEdit?u.renderEdit.call(n,e,s,Object.assign({$type:"edit",isEdit:!0},r),{$type:"edit",$grid:n.$xegrid,$excel:n.$parent,$table:n}):[]:a&&a.default?a.default.call(n,r,e):i?[_tools.UtilTools.formatText(_tools.UtilTools.getCellLabel(c,o,r),1)]:Cell.renderDefaultCell.call(l,e,r)}},_default=exports.Cell=Cell;exports.default=_default;