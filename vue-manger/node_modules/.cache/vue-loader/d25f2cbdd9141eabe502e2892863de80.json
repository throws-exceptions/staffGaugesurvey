{"remainingRequest":"/home/diamond/桌面/staffGaugesurvey/vue-manger/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/diamond/桌面/staffGaugesurvey/vue-manger/src/components/Tags.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/diamond/桌面/staffGaugesurvey/vue-manger/src/components/Tags.vue","mtime":1586747992546},{"path":"/home/diamond/桌面/staffGaugesurvey/vue-manger/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/diamond/桌面/staffGaugesurvey/vue-manger/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/diamond/桌面/staffGaugesurvey/vue-manger/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/diamond/桌面/staffGaugesurvey/vue-manger/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBidXMgZnJvbSAnLi9idXMnOwoKZXhwb3J0IGRlZmF1bHQgewogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICB0YWdzTGlzdDogW10KICAgIH0KICB9LAogIG1ldGhvZHM6IHsKICAgIGlzQWN0aXZlKHBhdGgpIHsKICAgICAgY29uc29sZS5sb2coJyBzZCcgKyBwYXRoKQogICAgICByZXR1cm4gcGF0aCA9PT0gdGhpcy4kcm91dGVyLmZ1bGxQYXRoOwogICAgfSwKICAgIC8vIOWFs+mXreWNleS4quagh+etvgogICAgY2xvc2VUYWdzKGluZGV4KSB7CiAgICAgIGNvbnN0IGRlbEl0ZW0gPSB0aGlzLnRhZ3NMaXN0LnNwbGljZShpbmRleCwgMSlbMF07CiAgICAgIGNvbnN0IGl0ZW0gPSB0aGlzLnRhZ3NMaXN0W2luZGV4XSA/IHRoaXMudGFnc0xpc3RbaW5kZXhdIDogdGhpcy50YWdzTGlzdFtpbmRleCAtIDFdOwogICAgICBpZiAoaXRlbSkgewogICAgICAgIGRlbEl0ZW0ucGF0aCA9PT0gdGhpcy4kcm91dGUuZnVsbFBhdGggJiYgdGhpcy4kcm91dGVyLnB1c2goaXRlbS5wYXRoKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLiRyb3V0ZXIucHVzaCgnLycpOwogICAgICB9CiAgICB9LAogICAgLy8g5YWz6Zet5YWo6YOo5qCH562+CiAgICBjbG9zZUFsbCgpIHsKICAgICAgdGhpcy50YWdzTGlzdCA9IFtdOwogICAgICB0aGlzLiRyb3V0ZXIucHVzaCgnLycpOwogICAgfSwKICAgIC8vIOWFs+mXreWFtuS7luagh+etvgogICAgY2xvc2VPdGhlcigpIHsKICAgICAgY29uc3QgY3VySXRlbSA9IHRoaXMudGFnc0xpc3QuZmlsdGVyKGl0ZW0gPT4gewogICAgICAgIHJldHVybiBpdGVtLnBhdGggPT09IHRoaXMuJHJvdXRlLmZ1bGxQYXRoOwogICAgICB9KQogICAgICB0aGlzLnRhZ3NMaXN0ID0gY3VySXRlbTsKICAgIH0sCiAgICAvLyDorr7nva7moIfnrb4KICAgIHNldFRhZ3Mocm91dGUpIHsKICAgICAgY29uc3QgaXNFeGlzdCA9IHRoaXMudGFnc0xpc3Quc29tZShpdGVtID0+IHsKICAgICAgICByZXR1cm4gaXRlbS5wYXRoID09PSByb3V0ZS5mdWxsUGF0aDsKICAgICAgfSkKICAgICAgaWYgKCFpc0V4aXN0KSB7CiAgICAgICAgaWYgKHRoaXMudGFnc0xpc3QubGVuZ3RoID49IDgpIHsKICAgICAgICAgIHRoaXMudGFnc0xpc3Quc2hpZnQoKTsKICAgICAgICB9CiAgICAgICAgdGhpcy50YWdzTGlzdC5wdXNoKHsKICAgICAgICAgIHRpdGxlOiByb3V0ZS5tZXRhLnRpdGxlLAogICAgICAgICAgcGF0aDogcm91dGUuZnVsbFBhdGgsCiAgICAgICAgICBuYW1lOiByb3V0ZS5tYXRjaGVkWzFdLmNvbXBvbmVudHMuZGVmYXVsdC5uYW1lCiAgICAgICAgfSkKICAgICAgfQogICAgICBidXMuJGVtaXQoJ3RhZ3MnLCB0aGlzLnRhZ3NMaXN0KTsKICAgIH0sCiAgICBoYW5kbGVUYWdzKGNvbW1hbmQpIHsKICAgICAgY29tbWFuZCA9PT0gJ290aGVyJyA/IHRoaXMuY2xvc2VPdGhlcigpIDogdGhpcy5jbG9zZUFsbCgpOwogICAgfQogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIHNob3dUYWdzKCkgewogICAgICByZXR1cm4gdGhpcy50YWdzTGlzdC5sZW5ndGggPiAwOwogICAgfQogIH0sCiAgd2F0Y2g6IHsKICAgICRyb3V0ZXIobmV3VmFsdWUsIG9sZFZhbHVlKSB7CiAgICAgIHRoaXMuc2V0VGFncyhuZXdWYWx1ZSk7CiAgICB9CiAgfSwKICBjcmVhdGVkKCkgewogICAgdGhpcy5zZXRUYWdzKHRoaXMuJHJvdXRlKTsKICAgIC8vIOebkeWQrOWFs+mXreW9k+WJjemhtemdoueahOagh+etvumhtQogICAgYnVzLiRvbignY2xvc2VfY3VycmVudF90YWdzJywgKCkgPT4gewogICAgICBmb3IgKGxldCBpID0gMCwgbGVuID0gdGhpcy50YWdzTGlzdC5sZW5ndGg7IGkgPCBsZW47IGkrKykgewogICAgICAgIGNvbnN0IGl0ZW0gPSB0aGlzLnRhZ3NMaXN0W2ldOwogICAgICAgIGlmIChpdGVtLnBhdGggPT09IHRoaXMuJHJvdXRlLmZ1bGxQYXRoKSB7CiAgICAgICAgICBpZiAoaSA8IGxlbiAtIDEpIHsKICAgICAgICAgICAgdGhpcy4kcm91dGVyLnB1c2godGhpcy50YWdzTGlzdFtpICsgMV0ucGF0aCk7CiAgICAgICAgICB9IGVsc2UgaWYgKGkgPiAwKSB7CiAgICAgICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHRoaXMudGFnc0xpc3RbaSAtIDFdLnBhdGgpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goJy8nKTsKICAgICAgICAgIH0KICAgICAgICAgIHRoaXMudGFnc0xpc3Quc3BsaWNlKGksIDEpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICB9CiAgICB9KQogIH0KfQoK"},{"version":3,"sources":["Tags.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAyBA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Tags.vue","sourceRoot":"src/components","sourcesContent":["<template>\r\n  <div class=\"tags\" v-if=\"showTags\">\r\n    <ul>\r\n      <li class=\"tags-li\" v-for=\"(item,index) in tagsList\" :class=\"{'active': isActive(item.path)}\" :key=\"index\">\r\n        <router-link :to=\"item.path\" class=\"tags-li-title\">\r\n          {{item.title}}\r\n        </router-link>\r\n        <span class=\"tags-li-icon\" @click=\"closeTags(index)\"><i class=\"el-icon-close\"></i></span>\r\n      </li>\r\n    </ul>\r\n    <div class=\"tags-close-box\">\r\n      <el-dropdown @command=\"handleTags\">\r\n        <el-button size=\"mini\" type=\"primary\">\r\n          标签选项<i class=\"el-icon-arrow-down el-icon--right\"></i>\r\n        </el-button>\r\n        <el-dropdown-menu size=\"small\" slot=\"dropdown\">\r\n          <el-dropdown-item command=\"other\">关闭其他</el-dropdown-item>\r\n          <el-dropdown-item command=\"all\">关闭所有</el-dropdown-item>\r\n        </el-dropdown-menu>\r\n      </el-dropdown>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n  import bus from './bus';\r\n\r\n  export default {\r\n    data() {\r\n      return {\r\n        tagsList: []\r\n      }\r\n    },\r\n    methods: {\r\n      isActive(path) {\r\n        console.log(' sd' + path)\r\n        return path === this.$router.fullPath;\r\n      },\r\n      // 关闭单个标签\r\n      closeTags(index) {\r\n        const delItem = this.tagsList.splice(index, 1)[0];\r\n        const item = this.tagsList[index] ? this.tagsList[index] : this.tagsList[index - 1];\r\n        if (item) {\r\n          delItem.path === this.$route.fullPath && this.$router.push(item.path);\r\n        } else {\r\n          this.$router.push('/');\r\n        }\r\n      },\r\n      // 关闭全部标签\r\n      closeAll() {\r\n        this.tagsList = [];\r\n        this.$router.push('/');\r\n      },\r\n      // 关闭其他标签\r\n      closeOther() {\r\n        const curItem = this.tagsList.filter(item => {\r\n          return item.path === this.$route.fullPath;\r\n        })\r\n        this.tagsList = curItem;\r\n      },\r\n      // 设置标签\r\n      setTags(route) {\r\n        const isExist = this.tagsList.some(item => {\r\n          return item.path === route.fullPath;\r\n        })\r\n        if (!isExist) {\r\n          if (this.tagsList.length >= 8) {\r\n            this.tagsList.shift();\r\n          }\r\n          this.tagsList.push({\r\n            title: route.meta.title,\r\n            path: route.fullPath,\r\n            name: route.matched[1].components.default.name\r\n          })\r\n        }\r\n        bus.$emit('tags', this.tagsList);\r\n      },\r\n      handleTags(command) {\r\n        command === 'other' ? this.closeOther() : this.closeAll();\r\n      }\r\n    },\r\n    computed: {\r\n      showTags() {\r\n        return this.tagsList.length > 0;\r\n      }\r\n    },\r\n    watch: {\r\n      $router(newValue, oldValue) {\r\n        this.setTags(newValue);\r\n      }\r\n    },\r\n    created() {\r\n      this.setTags(this.$route);\r\n      // 监听关闭当前页面的标签页\r\n      bus.$on('close_current_tags', () => {\r\n        for (let i = 0, len = this.tagsList.length; i < len; i++) {\r\n          const item = this.tagsList[i];\r\n          if (item.path === this.$route.fullPath) {\r\n            if (i < len - 1) {\r\n              this.$router.push(this.tagsList[i + 1].path);\r\n            } else if (i > 0) {\r\n              this.$router.push(this.tagsList[i - 1].path);\r\n            } else {\r\n              this.$router.push('/');\r\n            }\r\n            this.tagsList.splice(i, 1);\r\n            break;\r\n          }\r\n        }\r\n      })\r\n    }\r\n  }\r\n\r\n</script>\r\n\r\n\r\n<style>\r\n  .tags {\r\n    position: relative;\r\n    height: 30px;\r\n    overflow: hidden;\r\n    background: #fff;\r\n    padding-right: 120px;\r\n    box-shadow: 0 5px 10px #ddd;\r\n  }\r\n\r\n  .tags ul {\r\n    box-sizing: border-box;\r\n    width: 100%;\r\n    height: 100%;\r\n  }\r\n\r\n  .tags-li {\r\n    float: left;\r\n    margin: 3px 5px 2px 3px;\r\n    border-radius: 3px;\r\n    font-size: 12px;\r\n    overflow: hidden;\r\n    cursor: pointer;\r\n    height: 23px;\r\n    line-height: 23px;\r\n    border: 1px solid #e9eaec;\r\n    background: #fff;\r\n    padding: 0 5px 0 12px;\r\n    vertical-align: middle;\r\n    color: #666;\r\n    -webkit-transition: all .3s ease-in;\r\n    -moz-transition: all .3s ease-in;\r\n    transition: all .3s ease-in;\r\n  }\r\n\r\n  .tags-li:not(.active):hover {\r\n    background: #f8f8f8;\r\n  }\r\n\r\n  .tags-li.active {\r\n    color: #fff;\r\n  }\r\n\r\n  .tags-li-title {\r\n    float: left;\r\n    max-width: 80px;\r\n    overflow: hidden;\r\n    white-space: nowrap;\r\n    text-overflow: ellipsis;\r\n    margin-right: 5px;\r\n    color: #666;\r\n  }\r\n\r\n  .tags-li.active .tags-li-title {\r\n    color: #fff;\r\n  }\r\n\r\n  .tags-close-box {\r\n    position: absolute;\r\n    right: 0;\r\n    top: 0;\r\n    box-sizing: border-box;\r\n    padding-top: 1px;\r\n    text-align: center;\r\n    width: 110px;\r\n    height: 30px;\r\n    background: #fff;\r\n    box-shadow: -3px 0 15px 3px rgba(0, 0, 0, .1);\r\n    z-index: 10;\r\n  }\r\n\r\n</style>\r\n"]}]}